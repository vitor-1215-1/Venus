<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Admin - Loja Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --gray-900: #111827;
            --gray-800: #1f2937;
            --gray-700: #374151;
            --gray-600: #4b5563;
            --gray-500: #6b7280;
            --gray-400: #9ca3af;
            --gray-300: #d1d5db;
            --gray-200: #e5e7eb;
            --gray-100: #f3f4f6;
            --white: #ffffff;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--gray-100);
            color: var(--gray-900);
        }
        
        /* Login */
        .login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 2rem;
        }
        
        .login-box {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            width: 100%;
            max-width: 440px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
        }
        
        .login-logo {
            width: 64px;
            height: 64px;
            background: var(--primary);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 1.5rem;
        }
        
        .login-title {
            text-align: center;
            font-size: 1.875rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }
        
        .login-subtitle {
            text-align: center;
            color: var(--gray-600);
            margin-bottom: 2rem;
        }
        
        .tabs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            background: var(--gray-100);
            padding: 0.375rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }
        
        .tab {
            padding: 0.75rem;
            border: none;
            background: transparent;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .form-group { margin-bottom: 1.25rem; }
        
        .form-label {
            display: block;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--gray-300);
            border-radius: 10px;
            font-size: 0.95rem;
            font-family: inherit;
            transition: all 0.3s;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .form-textarea { resize: vertical; min-height: 100px; }
        
        .btn {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.4);
        }
        
        .alert {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            display: none;
        }
        
        .alert.show { display: block; }
        .alert-success { background: #d1fae5; color: var(--success); }
        .alert-error { background: #fee2e2; color: var(--danger); }
        
        /* Dashboard */
        .dashboard { display: none; }
        .dashboard.active { display: block; }
        
        .topbar {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .topbar-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .brand-logo-img {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            object-fit: cover;
            display: none;
        }
        
        .brand-logo-img.show {
            display: block;
        }
        
        .brand-logo {
            width: 48px;
            height: 48px;
            background: var(--primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .brand-name {
            font-size: 1.25rem;
            font-weight: 800;
        }
        
        .topbar-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .btn-logout {
            padding: 0.625rem 1.25rem;
            background: var(--gray-100);
            color: var(--gray-700);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .layout { display: flex; }
        
        .sidebar {
            width: 260px;
            background: white;
            border-right: 1px solid var(--gray-200);
            height: calc(100vh - 73px);
            position: sticky;
            top: 73px;
            padding: 1.5rem 0;
        }
        
        .sidebar-menu { list-style: none; }
        
        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.875rem 1.5rem;
            color: var(--gray-700);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }
        
        .sidebar-link:hover {
            background: var(--gray-50);
            color: var(--primary);
        }
        
        .sidebar-link.active {
            background: linear-gradient(90deg, rgba(37, 99, 235, 0.1) 0%, transparent 100%);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }
        
        .main-content {
            flex: 1;
            padding: 2rem;
            max-width: 1400px;
        }
        
        .page { display: none; }
        .page.active { display: block; }
        
        .page-header { margin-bottom: 2rem; }
        
        .page-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }
        
        .page-subtitle {
            color: var(--gray-600);
        }
        
        .card {
            background: white;
            border-radius: 16px;
            border: 1px solid var(--gray-200);
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title {
            font-size: 1.125rem;
            font-weight: 700;
        }
        
        .btn-add {
            padding: 0.625rem 1.25rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .btn-add:hover {
            background: var(--primary-dark);
        }
        
        .card-body { padding: 1.5rem; }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            text-align: left;
            padding: 1rem 1.5rem;
            background: var(--gray-50);
            font-weight: 700;
            font-size: 0.8rem;
            color: var(--gray-700);
            text-transform: uppercase;
        }
        
        td {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--gray-200);
        }
        
        tr:hover { background: var(--gray-50); }
        
        .badge {
            display: inline-block;
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .badge-success { background: #d1fae5; color: var(--success); }
        .badge-danger { background: #fee2e2; color: var(--danger); }
        
        .btn-sm {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            margin-right: 0.5rem;
        }
        
        .btn-edit { background: #3b82f6; color: white; }
        .btn-delete { background: var(--danger); color: white; }
        
        /* Categories Manager */
        .categories-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .category-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--primary);
            color: white;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .category-remove {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.25rem;
            line-height: 1;
        }
        
        .add-category {
            display: flex;
            gap: 0.5rem;
        }
        
        .add-category input {
            flex: 1;
        }
        
        /* Image Upload */
        .image-upload {
            width: 150px;
            height: 150px;
            border: 2px dashed var(--gray-300);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }
        
        .image-upload:hover {
            border-color: var(--primary);
        }
        
        .image-upload img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-upload input {
            display: none;
        }
        
        /* Banner Config */
        .banner-preview {
            width: 100%;
            height: 200px;
            background: var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 1rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 2rem;
        }
        
        .modal-overlay.active { display: flex; }
        
        .modal {
            background: white;
            border-radius: 20px;
            width: 100%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 2rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 800;
        }
        
        .btn-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--gray-400);
            cursor: pointer;
        }
        
        .modal-body { padding: 2rem; }
        
        .modal-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--gray-200);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }
        
        .btn-cancel {
            padding: 0.75rem 1.5rem;
            background: var(--gray-100);
            color: var(--gray-700);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .btn-save {
            padding: 0.75rem 1.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<!-- Login Page -->
<div class="login-page" id="loginPage">
    <div class="login-box">
        <div class="login-logo">üõçÔ∏è</div>
        <h1 class="login-title">Painel Admin</h1>
        <p class="login-subtitle">Sistema de Gerenciamento</p>
        
        <div class="alert alert-success" id="alertSuccess"></div>
        <div class="alert alert-error" id="alertError"></div>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('login')">Entrar</button>
            <button class="tab" onclick="switchTab('register')">Criar Conta</button>
        </div>
        
        <div class="tab-content active" id="loginContent">
            <form onsubmit="return doLogin(event)">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" class="form-input" id="loginPass" required>
                </div>
                <button type="submit" class="btn btn-primary">Entrar</button>
            </form>
        </div>
        
        <div class="tab-content" id="registerContent">
            <form onsubmit="return doRegister(event)">
                <div class="form-group">
                    <label class="form-label">Nome</label>
                    <input type="text" class="form-input" id="regName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="regEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" class="form-input" id="regPass" minlength="6" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Confirmar Senha</label>
                    <input type="password" class="form-input" id="regConfirm" required>
                </div>
                <button type="submit" class="btn btn-primary">Criar Conta</button>
            </form>
        </div>
    </div>
</div>

<!-- Dashboard -->
<div class="dashboard" id="dashboard">
    <div class="topbar">
        <div class="topbar-brand">
            <img id="topbarLogoImg" class="brand-logo-img" alt="Logo">
            <div id="topbarLogo" class="brand-logo">üõçÔ∏è</div>
            <div class="brand-name" id="brandName">Loja Premium</div>
        </div>
        <div class="topbar-actions">
            <button class="btn-logout" onclick="doLogout()">Sair</button>
        </div>
    </div>
    
    <div class="layout">
        <aside class="sidebar">
            <ul class="sidebar-menu">
                <li><a href="#" class="sidebar-link active" onclick="showPage(event, 'dashboardPage')">üìä Dashboard</a></li>
                <li><a href="#" class="sidebar-link" onclick="showPage(event, 'productsPage')">üõçÔ∏è Produtos</a></li>
                <li><a href="#" class="sidebar-link" onclick="showPage(event, 'categoriesPage')">üìÅ Categorias</a></li>
                <li><a href="#" class="sidebar-link" onclick="showPage(event, 'designPage')">üé® Design</a></li>
                <li><a href="#" class="sidebar-link" onclick="showPage(event, 'settingsPage')">‚öôÔ∏è Configura√ß√µes</a></li>
            </ul>
        </aside>
        
        <main class="main-content">
            <!-- Dashboard -->
            <div class="page active" id="dashboardPage">
                <div class="page-header">
                    <h1 class="page-title">Dashboard</h1>
                    <p class="page-subtitle">Vis√£o geral do seu neg√≥cio</p>
                </div>
            </div>
            
            <!-- Products -->
            <div class="page" id="productsPage">
                <div class="page-header">
                    <h1 class="page-title">Produtos</h1>
                    <p class="page-subtitle">Gerencie seus produtos</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Todos os Produtos</h3>
                        <button class="btn-add" onclick="openProductModal()">+ Adicionar</button>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Produto</th>
                                <th>Categoria</th>
                                <th>Pre√ßo</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="productsTable"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Categories -->
            <div class="page" id="categoriesPage">
                <div class="page-header">
                    <h1 class="page-title">Categorias</h1>
                    <p class="page-subtitle">Gerencie as categorias da loja</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Minhas Categorias</h3>
                    </div>
                    <div class="card-body">
                        <div class="categories-list" id="categoriesList"></div>
                        
                        <div class="add-category">
                            <input type="text" class="form-input" id="newCategory" placeholder="Nova categoria (ex: Masculino, Feminino...)">
                            <button class="btn-add" onclick="addCategory()">Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Design -->
            <div class="page" id="designPage">
                <div class="page-header">
                    <h1 class="page-title">Design da Loja</h1>
                    <p class="page-subtitle">Personalize a apar√™ncia</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Logo da Loja</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Upload da Logo</label>
                            <div class="image-upload" onclick="document.getElementById('logoInput').click()">
                                <input type="file" id="logoInput" accept="image/*" onchange="uploadLogo(event)">
                                <img id="logoPreview" style="display:none;">
                                <span id="logoPlaceholder">üì∑ Clique para adicionar</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Banner da Loja</h3>
                    </div>
                    <div class="card-body">
                        <div class="banner-preview" id="bannerPreview">LOJA PREMIUM</div>
                        
                        <div class="form-group">
                            <label class="form-label">Texto do Banner</label>
                            <input type="text" class="form-input" id="bannerText" value="LOJA PREMIUM" onchange="updateBannerPreview()">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Cor de Fundo</label>
                                <input type="color" class="form-input" id="bannerBg" value="#2563eb" onchange="updateBannerPreview()">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Cor do Texto</label>
                                <input type="color" class="form-input" id="bannerColor" value="#ffffff" onchange="updateBannerPreview()">
                            </div>
                        </div>
                        
                        <button class="btn-add" onclick="saveBanner()">Salvar Banner</button>
                    </div>
                </div>
            </div>
            
            <!-- Settings -->
            <div class="page" id="settingsPage">
                <div class="page-header">
                    <h1 class="page-title">Configura√ß√µes</h1>
                </div>
                
                <div class="alert alert-success" id="settingsAlert"></div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Informa√ß√µes da Loja</h3>
                    </div>
                    <div class="card-body">
                        <form onsubmit="return saveSettings(event)">
                            <div class="form-group">
                                <label class="form-label">Nome da Loja</label>
                                <input type="text" class="form-input" id="settingsName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Descri√ß√£o</label>
                                <textarea class="form-textarea" id="settingsDesc"></textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">WhatsApp</label>
                                    <input type="tel" class="form-input" id="settingsPhone" placeholder="(00) 00000-0000">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-input" id="settingsEmail">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Chave PIX</label>
                                <input type="text" class="form-input" id="settingsPix" required>
                            </div>
                            <button type="submit" class="btn-save">Salvar</button>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<!-- Product Modal -->
<div class="modal-overlay" id="productModal">
    <div class="modal">
        <div class="modal-header">
            <h2 class="modal-title" id="productModalTitle">Adicionar Produto</h2>
            <button class="btn-close" onclick="closeProductModal()">√ó</button>
        </div>
        <form onsubmit="return saveProduct(event)">
            <div class="modal-body">
                <input type="hidden" id="productId">
                
                <div class="form-group">
                    <label class="form-label">Nome do Produto</label>
                    <input type="text" class="form-input" id="productName" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Categoria</label>
                    <select class="form-select" id="productCategory" required>
                        <option value="">Selecione...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Pre√ßo (R$)</label>
                    <input type="number" class="form-input" id="productPrice" step="0.01" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Descri√ß√£o (Opcional)</label>
                    <textarea class="form-textarea" id="productDesc"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tamanhos (separados por v√≠rgula)</label>
                    <input type="text" class="form-input" id="productSizes" placeholder="P, M, G, GG">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Estoque por Tamanho</label>
                    <input type="text" class="form-input" id="productStock" placeholder="10, 5, 8, 3">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Badge</label>
                        <input type="text" class="form-input" id="productBadge" placeholder="Novo, Sale...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="productStatus">
                            <option value="active">Ativo</option>
                            <option value="inactive">Inativo</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">URL da Imagem</label>
                    <input type="url" class="form-input" id="productImage">
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn-cancel" onclick="closeProductModal()">Cancelar</button>
                <button type="submit" class="btn-save">Salvar</button>
            </div>
        </form>
    </div>
</div>

<script>
console.log('üöÄ Admin carregado');

var DB = {
    users: JSON.parse(localStorage.getItem('users') || '[]'),
    currentUser: JSON.parse(localStorage.getItem('currentUser') || 'null'),
    products: JSON.parse(localStorage.getItem('products') || '[]'),
    categories: JSON.parse(localStorage.getItem('categories') || '["Masculino","Feminino","Acess√≥rios"]'),
    config: JSON.parse(localStorage.getItem('config') || '{"name":"Loja Premium","desc":"","phone":"","email":"","pix":"","logo":"","bannerText":"LOJA PREMIUM","bannerBg":"#2563eb","bannerColor":"#ffffff"}')
};

function switchTab(tab) {
    var tabs = document.querySelectorAll('.tab');
    var contents = document.querySelectorAll('.tab-content');
    
    tabs.forEach(function(t) { t.classList.remove('active'); });
    contents.forEach(function(c) { c.classList.remove('active'); });
    
    event.target.classList.add('active');
    document.getElementById(tab + 'Content').classList.add('active');
}

function showAlert(type, msg) {
    var id = type === 'success' ? 'alertSuccess' : 'alertError';
    var alert = document.getElementById(id);
    alert.textContent = msg;
    alert.classList.add('show');
    setTimeout(function() { alert.classList.remove('show'); }, 3000);
}

function doRegister(e) {
    e.preventDefault();
    
    var name = document.getElementById('regName').value;
    var email = document.getElementById('regEmail').value;
    var pass = document.getElementById('regPass').value;
    var confirm = document.getElementById('regConfirm').value;
    
    if (pass !== confirm) {
        showAlert('error', 'As senhas n√£o coincidem!');
        return false;
    }
    
    if (DB.users.find(function(u) { return u.email === email; })) {
        showAlert('error', 'Email j√° cadastrado!');
        return false;
    }
    
    DB.users.push({ id: Date.now(), name: name, email: email, password: pass });
    localStorage.setItem('users', JSON.stringify(DB.users));
    
    showAlert('success', '‚úÖ Conta criada! Fa√ßa login.');
    
    setTimeout(function() {
        switchTab('login');
        e.target.reset();
    }, 2000);
    
    return false;
}

function doLogin(e) {
    e.preventDefault();
    
    var email = document.getElementById('loginEmail').value;
    var pass = document.getElementById('loginPass').value;
    
    var user = DB.users.find(function(u) { return u.email === email && u.password === pass; });
    
    if (!user) {
        showAlert('error', 'Email ou senha incorretos!');
        return false;
    }
    
    DB.currentUser = user;
    localStorage.setItem('currentUser', JSON.stringify(user));
    showDashboard();
    
    return false;
}

function doLogout() {
    localStorage.removeItem('currentUser');
    location.reload();
}

function showDashboard() {
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('dashboard').classList.add('active');
    
    document.getElementById('brandName').textContent = DB.config.name;
    
    if (DB.config.logo) {
        document.getElementById('topbarLogoImg').src = DB.config.logo;
        document.getElementById('topbarLogoImg').classList.add('show');
        document.getElementById('topbarLogo').style.display = 'none';
    }
    
    loadSettings();
    renderCategories();
    renderProducts();
    loadBannerConfig();
}

function showPage(e, pageId) {
    e.preventDefault();
    
    var links = document.querySelectorAll('.sidebar-link');
    var pages = document.querySelectorAll('.page');
    
    links.forEach(function(l) { l.classList.remove('active'); });
    pages.forEach(function(p) { p.classList.remove('active'); });
    
    e.currentTarget.classList.add('active');
    document.getElementById(pageId).classList.add('active');
}

function renderCategories() {
    var html = '';
    for (var i = 0; i < DB.categories.length; i++) {
        html += '<div class="category-tag">';
        html += '<span>' + DB.categories[i] + '</span>';
        html += '<button class="category-remove" onclick="removeCategory(' + i + ')">√ó</button>';
        html += '</div>';
    }
    document.getElementById('categoriesList').innerHTML = html;
    
    updateCategorySelects();
}

function addCategory() {
    var input = document.getElementById('newCategory');
    var category = input.value.trim();
    
    if (!category) {
        alert('Digite um nome para a categoria!');
        return;
    }
    
    if (DB.categories.includes(category)) {
        alert('Esta categoria j√° existe!');
        return;
    }
    
    DB.categories.push(category);
    localStorage.setItem('categories', JSON.stringify(DB.categories));
    
    input.value = '';
    renderCategories();
}

function removeCategory(index) {
    if (!confirm('Remover esta categoria?')) return;
    
    DB.categories.splice(index, 1);
    localStorage.setItem('categories', JSON.stringify(DB.categories));
    renderCategories();
}

function updateCategorySelects() {
    var select = document.getElementById('productCategory');
    var html = '<option value="">Selecione...</option>';
    
    for (var i = 0; i < DB.categories.length; i++) {
        html += '<option value="' + DB.categories[i] + '">' + DB.categories[i] + '</option>';
    }
    
    select.innerHTML = html;
}

function renderProducts() {
    var tbody = document.getElementById('productsTable');
    
    if (DB.products.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:var(--gray-500);padding:3rem;">Nenhum produto</td></tr>';
        return;
    }
    
    var html = '';
    
    for (var i = 0; i < DB.products.length; i++) {
        var p = DB.products[i];
        html += '<tr>';
        html += '<td><strong>' + p.name + '</strong></td>';
        html += '<td>' + p.category + '</td>';
        html += '<td><strong>R$ ' + parseFloat(p.price).toFixed(2) + '</strong></td>';
        html += '<td><span class="badge badge-' + (p.status === 'active' ? 'success' : 'danger') + '">' + (p.status === 'active' ? 'Ativo' : 'Inativo') + '</span></td>';
        html += '<td>';
        html += '<button class="btn-sm btn-edit" onclick="editProduct(' + p.id + ')">Editar</button>';
        html += '<button class="btn-sm btn-delete" onclick="deleteProduct(' + p.id + ')">Excluir</button>';
        html += '</td>';
        html += '</tr>';
    }
    
    tbody.innerHTML = html;
}

function openProductModal(id) {
    updateCategorySelects();
    document.getElementById('productModal').classList.add('active');
    
    if (id) {
        var p = DB.products.find(function(product) { return product.id === id; });
        document.getElementById('productModalTitle').textContent = 'Editar Produto';
        document.getElementById('productId').value = p.id;
        document.getElementById('productName').value = p.name;
        document.getElementById('productCategory').value = p.category;
        document.getElementById('productPrice').value = p.price;
        document.getElementById('productDesc').value = p.desc || '';
        document.getElementById('productSizes').value = p.sizes ? p.sizes.join(', ') : '';
        document.getElementById('productStock').value = p.stock ? p.stock.join(', ') : '';
        document.getElementById('productBadge').value = p.badge || '';
        document.getElementById('productStatus').value = p.status;
        document.getElementById('productImage').value = p.image || '';
    } else {
        document.getElementById('productModalTitle').textContent = 'Adicionar Produto';
        document.getElementById('productId').value = '';
        document.querySelector('#productModal form').reset();
    }
}

function closeProductModal() {
    document.getElementById('productModal').classList.remove('active');
}

function editProduct(id) {
    openProductModal(id);
}

function deleteProduct(id) {
    if (!confirm('Excluir este produto?')) return;
    
    DB.products = DB.products.filter(function(p) { return p.id !== id; });
    localStorage.setItem('products', JSON.stringify(DB.products));
    renderProducts();
}

function saveProduct(e) {
    e.preventDefault();
    
    var id = document.getElementById('productId').value;
    var sizesText = document.getElementById('productSizes').value;
    var sizes = sizesText ? sizesText.split(',').map(function(s) { return s.trim(); }) : [];
    var stockText = document.getElementById('productStock').value;
    var stock = stockText ? stockText.split(',').map(function(s) { return parseInt(s.trim()) || 0; }) : [];
    
    var product = {
        id: id ? parseInt(id) : Date.now(),
        name: document.getElementById('productName').value,
        category: document.getElementById('productCategory').value,
        price: parseFloat(document.getElementById('productPrice').value),
        desc: document.getElementById('productDesc').value,
        sizes: sizes,
        stock: stock,
        badge: document.getElementById('productBadge').value,
        status: document.getElementById('productStatus').value,
        image: document.getElementById('productImage').value
    };
    
    if (id) {
        var index = DB.products.findIndex(function(p) { return p.id === parseInt(id); });
        DB.products[index] = product;
    } else {
        DB.products.push(product);
    }
    
    localStorage.setItem('products', JSON.stringify(DB.products));
    renderProducts();
    closeProductModal();
    
    return false;
}

function uploadLogo(e) {
    var file = e.target.files[0];
    if (!file) return;
    
    var reader = new FileReader();
    reader.onload = function(event) {
        var logo = event.target.result;
        DB.config.logo = logo;
        localStorage.setItem('config', JSON.stringify(DB.config));
        
        document.getElementById('logoPreview').src = logo;
        document.getElementById('logoPreview').style.display = 'block';
        document.getElementById('logoPlaceholder').style.display = 'none';
        
        document.getElementById('topbarLogoImg').src = logo;
        document.getElementById('topbarLogoImg').classList.add('show');
        document.getElementById('topbarLogo').style.display = 'none';
    };
    reader.readAsDataURL(file);
}

function loadBannerConfig() {
    document.getElementById('bannerText').value = DB.config.bannerText || 'LOJA PREMIUM';
    document.getElementById('bannerBg').value = DB.config.bannerBg || '#2563eb';
    document.getElementById('bannerColor').value = DB.config.bannerColor || '#ffffff';
    updateBannerPreview();
    
    if (DB.config.logo) {
        document.getElementById('logoPreview').src = DB.config.logo;
        document.getElementById('logoPreview').style.display = 'block';
        document.getElementById('logoPlaceholder').style.display = 'none';
    }
}

function updateBannerPreview() {
    var preview = document.getElementById('bannerPreview');
    preview.textContent = document.getElementById('bannerText').value;
    preview.style.background = document.getElementById('bannerBg').value;
    preview.style.color = document.getElementById('bannerColor').value;
}

function saveBanner() {
    DB.config.bannerText = document.getElementById('bannerText').value;
    DB.config.bannerBg = document.getElementById('bannerBg').value;
    DB.config.bannerColor = document.getElementById('bannerColor').value;
    localStorage.setItem('config', JSON.stringify(DB.config));
    alert('‚úÖ Banner salvo com sucesso!');
}

function loadSettings() {
    document.getElementById('settingsName').value = DB.config.name;
    document.getElementById('settingsDesc').value = DB.config.desc || '';
    document.getElementById('settingsPhone').value = DB.config.phone || '';
    document.getElementById('settingsEmail').value = DB.config.email || '';
    document.getElementById('settingsPix').value = DB.config.pix || '';
}

function saveSettings(e) {
    e.preventDefault();
    
    DB.config.name = document.getElementById('settingsName').value;
    DB.config.desc = document.getElementById('settingsDesc').value;
    DB.config.phone = document.getElementById('settingsPhone').value;
    DB.config.email = document.getElementById('settingsEmail').value;
    DB.config.pix = document.getElementById('settingsPix').value;
    
    localStorage.setItem('config', JSON.stringify(DB.config));
    document.getElementById('brandName').textContent = DB.config.name;
    
    var alert = document.getElementById('settingsAlert');
    alert.textContent = '‚úÖ Configura√ß√µes salvas!';
    alert.classList.add('show');
    setTimeout(function() { alert.classList.remove('show'); }, 3000);
    
    return false;
}

window.addEventListener('storage', function(e) {
    if (e.key === 'newOrder') {
        var order = JSON.parse(e.newValue);
        alert('üéâ Novo Pedido!\n\n#' + order.id + '\n' + order.customerName + '\nR$ ' + order.total.toFixed(2));
        localStorage.removeItem('newOrder');
    }
});

if (DB.currentUser) {
    showDashboard();
}

if (DB.products.length === 0) {
    DB.products = [
        { id: 1, name: 'Camiseta Premium', category: 'Feminino', price: 89.90, desc: 'Camiseta de algod√£o', sizes: ['P','M','G','GG'], stock: [10,5,2,0], badge: 'Novo', status: 'active', image: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400' },
        { id: 2, name: 'Cal√ßa Jeans', category: 'Masculino', price: 149.90, desc: 'Cal√ßa jeans slim', sizes: ['38','40','42'], stock: [8,12,6], badge: '', status: 'active', image: 'https://images.unsplash.com/photo-1542272604-787c3835535d?w=400' }
    ];
    localStorage.setItem('products', JSON.stringify(DB.products));
}

console.log('‚úÖ Sistema pronto!');
</script>

</body>
</html>
